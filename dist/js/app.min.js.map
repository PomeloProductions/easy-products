{"version":3,"sources":["node_modules/browser-pack/_prelude.js","assets/js/app/classes/CookieFactory.js","assets/js/app/classes/Product.js","assets/js/app/classes/ShippingField.js","assets/js/app/classes/ShippingManager.js","assets/js/app/classes/ShoppingCart.js","assets/js/app/main.js"],"names":[],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Created by bryce on 2/16/17.\n */\n\nexport class CookieFactory {\n\n    /**\n     * Default constructor, requires a namespace being passed in for prefixing all data\n     *\n     * @param nameSpace\n     */\n    constructor(nameSpace) {\n        this.nameSpace = nameSpace;\n    }\n\n    /**\n     * Saves a cookie to persistent storage\n     *\n     * @param name The key of the cookie\n     * @param value The new value of the cookie\n     */\n    saveCookie(name, value) {\n        document.cookie = this.nameSpace + \"-\" + name + \"=\" + value + \"; path=/\";\n    }\n\n    /**\n     * Saves a json object as a cookie\n     *\n     * @param name The key for the cookie\n     * @param value The json object to save\n     */\n    saveJSON(name, value) {\n\n        this.saveCookie(name, JSON.stringify(value));\n    }\n\n    /**\n     * Loads a cookie out of the document cookie list\n     *\n     * @param name The name of the cookie we are loading\n     * @returns {*} the new object\n     */\n    loadCookie(name) {\n\n        name = this.nameSpace + \"-\" + name + \"=\";\n        let ca = document.cookie.split(';');\n\n        for (let i=0; i<ca.length; i++) {\n\n            let c = ca[i];\n            while (c.charAt(0) == ' ') {\n                c = c.substring(1);\n            }\n\n            if (c.indexOf(name) == 0) {\n                return c.substring(name.length,c.length);\n            }\n        }\n\n        return undefined;\n    }\n\n    /**\n     * Parses a json object from a cookie, or returns an empty JSON\n     *\n     * @param name The name of the json we are loading\n     * @returns {{}} The found object\n     */\n    loadJSON(name) {\n        let content = this.loadCookie(name);\n\n        if (typeof content == \"undefined\")\n            return {};\n        else\n            return JSON.parse(content);\n    }\n\n    /**\n     * Parses a number from a cookie\n     *\n     * @param name The cookie we are looking for\n     * @param defaultValue The default to return if the cookie was not found\n     * @returns {*}\n     */\n    loadNumber(name, defaultValue) {\n        let content = this.loadCookie(name);\n\n        if (typeof content == \"undefined\")\n            return defaultValue;\n\n        return Number(content);\n    }\n\n    /**\n     * Parses a boolean value from a cookie\n     *\n     * @param name The cookie we are looking for\n     * @param defaultValue A default to return if the value was undefined\n     * @returns {*}\n     */\n    loadBoolean (name, defaultValue) {\n        let content = this.loadCookie(name);\n\n        if (typeof content == \"undefined\")\n            return defaultValue;\n\n        return content == 'true';\n    }\n}","/**\n * Created by bryce on 2/8/17.\n */\n\nexport class Product {\n\n    /**\n     * Creates a new instance of a product\n     *\n     * @param productContainer The container that will hold all data for this product\n     * @param quantityChangedCallback\n     */\n    constructor (productContainer, quantityChangedCallback) {\n\n        this.quantityChangedCallback = quantityChangedCallback;\n\n        this.shippingOptions = {};\n        this.quantity = 0;\n        this.total = 0;\n\n        this.id = productContainer.dataset['id'];\n        this.cost = productContainer.dataset['cost'];\n        this.weight = productContainer.dataset['weight'];\n\n        let shippingDivs = productContainer.getElementsByClassName('easy_products-shipping_option');\n\n        for (let i = 0; i < shippingDivs.length; i++) {\n\n            let shippingDiv = shippingDivs[i];\n\n            let regionId = shippingDiv.dataset['region_id'];\n\n            let key = regionId ? regionId : 'default';\n\n            this.shippingOptions[key] = {\n                primary_rate: Number(shippingDiv.dataset['primary_rate']),\n                add_on_rate: Number(shippingDiv.dataset['add_on_rate'])\n            };\n        }\n\n        this.quantityInput = productContainer.querySelector('.easy_products-quantity_input');\n        this.totalDisplay = productContainer.querySelector('.easy_products-product_total_display');\n        this.productTotal = productContainer.querySelector('.easy_products-product_total');\n\n        this.quantityInput.addEventListener('change', this.quantityChanged.bind(this));\n    }\n\n    /**\n     * Sets the quantity and updates the cost variables\n     *\n     * @param quantity\n     */\n    setQuantity (quantity) {\n        this.quantity = quantity;\n        this.total = quantity * this.cost;\n\n        if (this.quantity != this.quantityInput.value) {\n            this.quantityInput.value = this.quantity;\n        }\n\n        if (this.total > 0) {\n            this.productTotal.innerHTML = this.total.toFixed(2);\n            this.totalDisplay.style.display = ''\n        }\n        else {\n            this.totalDisplay.style.display = 'none';\n        }\n    }\n\n    /**\n     * Called when quantity has changed in the input, and will recalculate the totals for this product\n     */\n    quantityChanged () {\n\n        let quantity = Number(this.quantityInput.value);\n\n        if (isNaN(quantity)) {\n            quantity = 0;\n        }\n\n        this.setQuantity(quantity);\n\n        if (typeof this.quantityChangedCallback == 'function') {\n            this.quantityChangedCallback(this);\n        }\n    }\n\n    /**\n     * retrieves the shipping rate for the specified region\n     *\n     * @param regionId\n     * @returns {*}\n     */\n    retrieveShippingRates (regionId) {\n        let rates = this.shippingOptions[regionId];\n\n        return rates ? rates : this.shippingOptions['default'];\n    }\n\n    /**\n     * Compare function for comparing weights of two products\n     *\n     * @param a Product\n     * @param b Product\n     * @returns {number}\n     */\n    static compareWeights (a, b) {\n        if (a.weight < b.weight) {\n            return -1;\n        }\n        if (a.weight > b.weight) {\n            return 1;\n        }\n        return 0;\n    }\n}","/**\n * Created by bryce on 2/16/17.\n */\n\nexport class ShippingField {\n\n    /**\n     * Default constructor for a field\n     *\n     * @param field HTMLNode\n     * @param changeCallback Function\n     * @param cookieFactory CookieFactory\n     * @param cookieKey The key for the stored cookie\n     */\n    constructor (field, changeCallback, cookieFactory, cookieKey) {\n\n        this.field = field;\n        this.changeCallback = changeCallback;\n        this.cookieFactory = cookieFactory;\n        this.cookieKey = cookieKey;\n\n        this.valueEntered = false;\n        this.required = this.field.hasAttribute('required');\n\n        this.blankValue = this.field.dataset['blank_value'];\n\n        let storedValue = this.cookieFactory.loadCookie(this.cookieKey);\n\n        if (storedValue) {\n            this.field.value = storedValue;\n            this.checkInputValue();\n        }\n\n        this.field.addEventListener('change', this.verifyInputValue.bind(this));\n    }\n\n    /**\n     * Determines if the user has entered a proper value\n     */\n    checkInputValue () {\n\n        this.valueEntered = false;\n\n        if (this.field.value) {\n\n            if (this.blankValue) {\n                this.valueEntered = this.blankValue != this.field.value;\n            }\n            else {\n                this.valueEntered = true;\n            }\n        }\n    }\n\n    /**\n     * double checks input value when it changes to verify a value was entered properly\n     */\n    verifyInputValue () {\n        this.checkInputValue();\n\n        if (this.valueEntered) {\n            this.cookieFactory.saveCookie(this.cookieKey, this.field.value);\n            this.changeCallback();\n        }\n    }\n\n    /**\n     * Checks whether or not this field is ready for submission\n     *\n     * @returns Boolean\n     */\n    checkIfComplete () {\n\n        return this.required ? this.valueEntered : true;\n    }\n}","/**\n * Created by bryce on 2/16/17.\n */\n\nimport {ShippingField} from './ShippingField';\n\nexport class ShippingManager {\n\n    /**\n     * Manages the current state of the shipping options\n     *\n     * @param form\n     * @param addressChangeCallback function\n     * @param cookieFactory CookieFactory\n     */\n    constructor (form, addressChangeCallback, cookieFactory) {\n\n        ShippingManager.NAME_COOKIE = \"name\";\n        ShippingManager.ADDRESS_1_COOKIE = \"address_1\";\n        ShippingManager.ADDRESS_2_COOKIE = \"address_2\";\n        ShippingManager.CITY_COOKIE = \"city\";\n        ShippingManager.POSTAL_CODE_COOKIE = \"postal_code\";\n        ShippingManager.STATE_COOKIE = \"state\";\n        ShippingManager.COUNTRY_COOKIE = \"country\";\n\n        let nameInput = form.querySelector(\"#easy_products-name\");\n        let address1Input = form.querySelector(\"#easy_products-address_1\");\n        let address2Input = form.querySelector(\"#easy_products-address_2\");\n        let cityInput = form.querySelector(\"#easy_products-city\");\n        let postalCodeInput = form.querySelector(\"#easy_products-postal_code\");\n        let stateInput = form.querySelector(\"#easy_products-state\");\n        let countrySelect = form.querySelector(\"#easy_products-country\");\n\n        this.nameField = new ShippingField(nameInput, addressChangeCallback, cookieFactory, ShippingManager.NAME_COOKIE);\n        this.address1Field = new ShippingField(address1Input, addressChangeCallback, cookieFactory, ShippingManager.ADDRESS_1_COOKIE);\n        this.address2Field = new ShippingField(address2Input, addressChangeCallback, cookieFactory, ShippingManager.ADDRESS_2_COOKIE);\n        this.cityField = new ShippingField(cityInput, addressChangeCallback, cookieFactory, ShippingManager.CITY_COOKIE);\n        this.postalCodeField = new ShippingField(postalCodeInput, addressChangeCallback, cookieFactory, ShippingManager.POSTAL_CODE_COOKIE);\n        this.stateField = new ShippingField(stateInput, addressChangeCallback, cookieFactory, ShippingManager.STATE_COOKIE);\n        this.countryField = new ShippingField(countrySelect, addressChangeCallback, cookieFactory, ShippingManager.COUNTRY_COOKIE);\n    }\n\n    /**\n     * Checks all fields to see if the shipping is ready to go\n     *\n     * @returns {Boolean}\n     */\n    checkIfShippingComplete() {\n\n        return this.nameField.checkIfComplete() && this.address1Field.checkIfComplete()\n                && this.address2Field.checkIfComplete() && this.cityField.checkIfComplete()\n                && this.postalCodeField.checkIfComplete() && this.stateField.checkIfComplete()\n                && this.countryField.checkIfComplete();\n    }\n\n    /**\n     * Gets the selected region id or undefined if none has been found\n     *\n     * @returns Boolean|undefined\n     */\n    getRegionId () {\n        return this.countryField.checkIfComplete() ? this.countryField.field.value : undefined;\n    }\n}","/**\n * Created by bryce on 2/8/17.\n */\n\nimport {Product} from './Product';\nimport {CookieFactory} from './CookieFactory';\nimport {ShippingManager} from './ShippingManager';\n\nexport class ShoppingCart {\n\n    /**\n     * Constructor for this shopping cart instance\n     *\n     * @param productsForm the dom form\n     */\n    constructor (productsForm) {\n        ShoppingCart.PRODUCTS_COOKIE = 'product_quantities';\n\n        this.productsForm = productsForm;\n\n        this.subtotalDisplay = this.productsForm.querySelector('#easy_products-subtotal');\n        this.shippingDisplay = this.productsForm.querySelector('#easy_products-shipping_total');\n        this.totalDisplay = this.productsForm.querySelector('#easy_products-total');\n\n        this.submitButton = this.productsForm.querySelector('#easy_products-submit');\n\n        this.cookieFactory = new CookieFactory('easy_products');\n\n        this.productQuantities = this.cookieFactory.loadJSON(ShoppingCart.PRODUCTS_COOKIE);\n        let unsortedProducts = [];\n\n        let productContainers = this.productsForm.getElementsByClassName('easy_products-product');\n\n        for (let i = 0; i < productContainers.length; i++) {\n\n            let product = new Product(productContainers[i], this.quantityChanged.bind(this));\n\n            let storedQuantity = this.productQuantities[product.id];\n\n            if (typeof storedQuantity != 'number') {\n                storedQuantity = 0;\n            }\n\n            product.setQuantity(storedQuantity);\n\n            unsortedProducts.push(product);\n        }\n\n        this.products = unsortedProducts.sort(Product.compareWeights).reverse();\n\n        this.shippingManager = new ShippingManager(this.productsForm, this.checkShippingAddress.bind(this), this.cookieFactory);\n\n        this.calculateTotals();\n\n        if (document.readyState === \"complete\" || document.readyState === \"loaded\") {\n            this.setupSubmitCallback();\n        }\n        else {\n            document.addEventListener('DOMContentLoaded', this.setupSubmitCallback.bind(this));\n        }\n\n    }\n\n    /**\n     * Sets up the complete callback\n     */\n    setupSubmitCallback () {\n\n        let submitCallbackName = this.productsForm.dataset['submit_callback'];\n\n        if (submitCallbackName) {\n            let submitCallback = eval(submitCallbackName);\n\n            if (typeof submitCallback == 'function') {\n                this.submitCallback = submitCallback;\n            }\n        }\n\n        this.productsForm.addEventListener('submit', this.submitForm.bind(this));\n    }\n\n    /**\n     * Stops the submission if a complete callback is set\n     *\n     * @param event\n     */\n    submitForm (event) {\n        if (this.submitCallback) {\n            event.preventDefault();\n\n            this.submitCallback(this.total);\n        }\n    }\n\n    /**\n     * checks to see if the shipping address has been changed\n     */\n    checkShippingAddress () {\n\n        if (this.shippingManager.checkIfShippingComplete()) {\n            this.calculateTotals();\n        }\n        else {\n            this.shippingDisplay.innerHTML = 'Please Enter Your Shipping Address';\n            this.totalDisplay.innerHTML = 'Please Enter Your Shipping Address';\n\n            this.submitButton.disabled = true;\n        }\n    }\n\n    /**\n     * Called whenever a quantity has changed\n     *\n     * @param product Product\n     */\n    quantityChanged (product) {\n        this.productQuantities[product.id] = product.quantity;\n        this.cookieFactory.saveJSON(ShoppingCart.PRODUCTS_COOKIE, this.productQuantities);\n\n        this.calculateTotals();\n    }\n\n    /**\n     * Recalculates all totals\n     */\n    calculateTotals () {\n\n        let subtotal = 0;\n        for (let i = 0; i < this.products.length; i++) {\n            subtotal+= this.products[i].total;\n        }\n\n        this.subtotalDisplay.innerHTML = '$' + subtotal.toFixed(2);\n\n        if (this.shippingManager.checkIfShippingComplete()) {\n\n            let shippingTotal = 0;\n            let regionId = this.shippingManager.getRegionId();\n\n            for (let i = 0; i < this.products.length; i++) {\n                let product = this.products[i];\n\n                if (product.quantity) {\n\n                    let shippingRates = product.retrieveShippingRates(regionId);\n\n                    let addOnQuantity = product.quantity;\n\n                    if (shippingTotal == 0) {\n                        shippingTotal+= shippingRates.primary_rate;\n                        addOnQuantity--;\n                    }\n                    if (addOnQuantity) {\n                        shippingTotal+= shippingRates.add_on_rate * addOnQuantity;\n                    }\n                }\n            }\n\n            this.shippingDisplay.innerHTML = '$' + shippingTotal.toFixed(2);\n\n            this.total = subtotal + shippingTotal;\n\n            this.totalDisplay.innerHTML = '$' + this.total.toFixed(2);\n\n            this.submitButton.disabled = false;\n        }\n    }\n}","/**\n * Created by bryce on 2/8/17.\n */\n\nimport {ShoppingCart} from './classes/ShoppingCart';\n\nlet productsForm = document.getElementById('easy_products-products_list');\n\nif (typeof productsForm != 'undefined') {\n    new ShoppingCart(productsForm);\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvYXBwL2NsYXNzZXMvQ29va2llRmFjdG9yeS5qcyIsImFzc2V0cy9qcy9hcHAvY2xhc3Nlcy9Qcm9kdWN0LmpzIiwiYXNzZXRzL2pzL2FwcC9jbGFzc2VzL1NoaXBwaW5nRmllbGQuanMiLCJhc3NldHMvanMvYXBwL2NsYXNzZXMvU2hpcHBpbmdNYW5hZ2VyLmpzIiwiYXNzZXRzL2pzL2FwcC9jbGFzc2VzL1Nob3BwaW5nQ2FydC5qcyIsImFzc2V0cy9qcy9hcHAvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7QUNBQTs7OztJQUlhLGEsV0FBQSxhOztBQUVUOzs7OztBQUtBLDJCQUFZLFNBQVosRUFBdUI7QUFBQTs7QUFDbkIsYUFBSyxTQUFMLEdBQWlCLFNBQWpCO0FBQ0g7O0FBRUQ7Ozs7Ozs7Ozs7bUNBTVcsSSxFQUFNLEssRUFBTztBQUNwQixxQkFBUyxNQUFULEdBQWtCLEtBQUssU0FBTCxHQUFpQixHQUFqQixHQUF1QixJQUF2QixHQUE4QixHQUE5QixHQUFvQyxLQUFwQyxHQUE0QyxVQUE5RDtBQUNIOztBQUVEOzs7Ozs7Ozs7aUNBTVMsSSxFQUFNLEssRUFBTzs7QUFFbEIsaUJBQUssVUFBTCxDQUFnQixJQUFoQixFQUFzQixLQUFLLFNBQUwsQ0FBZSxLQUFmLENBQXRCO0FBQ0g7O0FBRUQ7Ozs7Ozs7OzttQ0FNVyxJLEVBQU07O0FBRWIsbUJBQU8sS0FBSyxTQUFMLEdBQWlCLEdBQWpCLEdBQXVCLElBQXZCLEdBQThCLEdBQXJDO0FBQ0EsZ0JBQUksS0FBSyxTQUFTLE1BQVQsQ0FBZ0IsS0FBaEIsQ0FBc0IsR0FBdEIsQ0FBVDs7QUFFQSxpQkFBSyxJQUFJLElBQUUsQ0FBWCxFQUFjLElBQUUsR0FBRyxNQUFuQixFQUEyQixHQUEzQixFQUFnQzs7QUFFNUIsb0JBQUksSUFBSSxHQUFHLENBQUgsQ0FBUjtBQUNBLHVC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QixDQUFyQixFQUF3QjtBQUNwQiw2Q0FBZ0IsY0FBYyxZQUE5QjtBQUNBO0FBQ0g7QUFDRCw0QkFBSSxhQUFKLEVBQW1CO0FBQ2YsNkNBQWdCLGNBQWMsV0FBZCxHQUE0QixhQUE1QztBQUNIO0FBQ0o7QUFDSjs7QUFFRCxxQkFBSyxlQUFMLENBQXFCLFNBQXJCLEdBQWlDLE1BQU0sY0FBYyxPQUFkLENBQXNCLENBQXRCLENBQXZDOztBQUVBLHFCQUFLLEtBQUwsR0FBYSxXQUFXLGFBQXhCOztBQUVBLHFCQUFLLFlBQUwsQ0FBa0IsU0FBbEIsR0FBOEIsTUFBTSxLQUFLLEtBQUwsQ0FBVyxPQUFYLENBQW1CLENBQW5CLENBQXBDOztBQUVBLHFCQUFLLFlBQUwsQ0FBa0IsUUFBbEIsR0FBNkIsS0FBN0I7QUFDSDtBQUNKOzs7Ozs7Ozs7QUNsS0w7O0FBRUEsSUFBSSxlQUFlLFNBQVMsY0FBVCxDQUF3Qiw2QkFBeEIsQ0FBbkIsQyxDQU5BOzs7O0FBUUEsSUFBSSxPQUFPLFlBQVAsSUFBdUIsV0FBM0IsRUFBd0M7QUFDcEMsaUNBQWlCLFlBQWpCO0FBQ0giLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGJyeWNlIG9uIDIvMTYvMTcuXG4gKi9cblxuZXhwb3J0IGNsYXNzIENvb2tpZUZhY3Rvcnkge1xuXG4gICAgLyoqXG4gICAgICogRGVmYXVsdCBjb25zdHJ1Y3RvciwgcmVxdWlyZXMgYSBuYW1lc3BhY2UgYmVpbmcgcGFzc2VkIGluIGZvciBwcmVmaXhpbmcgYWxsIGRhdGFcbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lU3BhY2VcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihuYW1lU3BhY2UpIHtcbiAgICAgICAgdGhpcy5uYW1lU3BhY2UgPSBuYW1lU3BhY2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZXMgYSBjb29raWUgdG8gcGVyc2lzdGVudCBzdG9yYWdlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZSBUaGUga2V5IG9mIHRoZSBjb29raWVcbiAgICAgKiBAcGFyYW0gdmFsdWUgVGhlIG5ldyB2YWx1ZSBvZiB0aGUgY29va2llXG4gICAgICovXG4gICAgc2F2ZUNvb2tpZShuYW1lLCB2YWx1ZSkge1xuICAgICAgICBkb2N1bWVudC5jb29raWUgPSB0aGlzLm5hbWVTcGFjZSArIFwiLVwiICsgbmFtZSArIFwiPVwiICsgdmFsdWUgKyBcIjsgcGF0aD0vXCI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZXMgYSBqc29uIG9iamVjdCBhcyBhIGNvb2tpZVxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIGtleSBmb3IgdGhlIGNvb2tpZVxuICAgICAqIEBwYXJhbSB2YWx1ZSBUaGUganNvbiBvYmplY3QgdG8gc2F2ZVxuICAgICAqL1xuICAgIHNhdmVKU09OKG5hbWUsIHZhbHVlKSB7XG5cbiAgICAgICAgdGhpcy5zYXZlQ29va2llKG5hbWUsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZHMgYSBjb29raWUgb3V0IG9mIHRoZSBkb2N1bWVudCBjb29raWUgbGlzdFxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgb2YgdGhlIGNvb2tpZSB3ZSBhcmUgbG9hZGluZ1xuICAgICAqIEByZXR1cm5zIHsqfSB0aGUgbmV3IG9iamVjdFxuICAgICAqL1xuICAgIGxvYWRDb29raWUobmFtZSkge1xuXG4gICAgICAgIG5hbWUgPSB0aGlzLm5hbWVTcGFjZSArIFwiLVwiICsgbmFtZSArIFwiPVwiO1xuICAgICAgICBsZXQgY2EgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcblxuICAgICAgICBmb3IgKGxldCBpPTA7IGk8Y2EubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgbGV0IGMgPSBjYVtpXTtcbiAgICAgICAgICAgIHdoaWxlIChjLmNoYXJBdCgwKSA9PSAnICcpIHtcbiAgICAgICAgICAgICAgICBjID0gYy5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjLmluZGV4T2YobmFtZSkgPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjLnN1YnN0cmluZyhuYW1lLmxlbmd0aCxjLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIGpzb24gb2JqZWN0IGZyb20gYSBjb29raWUsIG9yIHJldHVybnMgYW4gZW1wdHkgSlNPTlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgb2YgdGhlIGpzb24gd2UgYXJlIGxvYWRpbmdcbiAgICAgKiBAcmV0dXJucyB7e319IFRoZSBmb3VuZCBvYmplY3RcbiAgICAgKi9cbiAgICBsb2FkSlNPTihuYW1lKSB7XG4gICAgICAgIGxldCBjb250ZW50ID0gdGhpcy5sb2FkQ29va2llKG5hbWUpO1xuXG4gICAgICAgIGlmICh0eXBlb2YgY29udGVudCA9PSBcInVuZGVmaW5lZFwiKVxuICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShjb250ZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBudW1iZXIgZnJvbSBhIGNvb2tpZVxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIGNvb2tpZSB3ZSBhcmUgbG9va2luZyBmb3JcbiAgICAgKiBAcGFyYW0gZGVmYXVsdFZhbHVlIFRoZSBkZWZhdWx0IHRvIHJldHVybiBpZiB0aGUgY29va2llIHdhcyBub3QgZm91bmRcbiAgICAgKiBAcmV0dXJucyB7Kn1cbiAgICAgKi9cbiAgICBsb2FkTnVtYmVyKG5hbWUsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICBsZXQgY29udGVudCA9IHRoaXMubG9hZENvb2tpZShuYW1lKTtcblxuICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT0gXCJ1bmRlZmluZWRcIilcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG5cbiAgICAgICAgcmV0dXJuIE51bWJlcihjb250ZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBib29sZWFuIHZhbHVlIGZyb20gYSBjb29raWVcbiAgICAgKlxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBjb29raWUgd2UgYXJlIGxvb2tpbmcgZm9yXG4gICAgICogQHBhcmFtIGRlZmF1bHRWYWx1ZSBBIGRlZmF1bHQgdG8gcmV0dXJuIGlmIHRoZSB2YWx1ZSB3YXMgdW5kZWZpbmVkXG4gICAgICogQHJldHVybnMgeyp9XG4gICAgICovXG4gICAgbG9hZEJvb2xlYW4gKG5hbWUsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICBsZXQgY29udGVudCA9IHRoaXMubG9hZENvb2tpZShuYW1lKTtcblxuICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT0gXCJ1bmRlZmluZWRcIilcbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG5cbiAgICAgICAgcmV0dXJuIGNvbnRlbnQgPT0gJ3RydWUnO1xuICAgIH1cbn0iLCIvKipcbiAqIENyZWF0ZWQgYnkgYnJ5Y2Ugb24gMi84LzE3LlxuICovXG5cbmV4cG9ydCBjbGFzcyBQcm9kdWN0IHtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgYSBwcm9kdWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJvZHVjdENvbnRhaW5lciBUaGUgY29udGFpbmVyIHRoYXQgd2lsbCBob2xkIGFsbCBkYXRhIGZvciB0aGlzIHByb2R1Y3RcbiAgICAgKiBAcGFyYW0gcXVhbnRpdHlDaGFuZ2VkQ2FsbGJhY2tcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvciAocHJvZHVjdENvbnRhaW5lciwgcXVhbnRpdHlDaGFuZ2VkQ2FsbGJhY2spIHtcblxuICAgICAgICB0aGlzLnF1YW50aXR5Q2hhbmdlZENhbGxiYWNrID0gcXVhbnRpdHlDaGFuZ2VkQ2FsbGJhY2s7XG5cbiAgICAgICAgdGhpcy5zaGlwcGluZ09wdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5xdWFudGl0eSA9IDA7XG4gICAgICAgIHRoaXMudG90YWwgPSAwO1xuXG4gICAgICAgIHRoaXMuaWQgPSBwcm9kdWN0Q29udGFpbmVyLmRhdGFzZXRbJ2lkJ107XG4gICAgICAgIHRoaXMuY29zdCA9IHByb2R1Y3RDb250YWluZXIuZGF0YXNldFsnY29zdCddO1xuICAgICAgICB0aGlzLndlaWdodCA9IHByb2R1Y3RDb250YWluZXIuZGF0YXNldFsnd2VpZ2h0J107XG5cbiAgICAgICAgbGV0IHNoaXBwaW5nRGl2cyA9IHByb2R1Y3RDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZWFzeV9wcm9kdWN0cy1zaGlwcGluZ19vcHRpb24nKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBwaW5nRGl2cy5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICBsZXQgc2hpcHBpbmdEaXYgPSBzaGlwcGluZ0RpdnNbaV07XG5cbiAgICAgICAgICAgIGxldCByZWdpb25JZCA9IHNoaXBwaW5nRGl2LmRhdGFzZXRbJ3JlZ2lvbl9pZCddO1xuXG4gICAgICAgICAgICBsZXQga2V5ID0gcmVnaW9uSWQgPyByZWdpb25JZCA6ICdkZWZhdWx0JztcblxuICAgICAgICAgICAgdGhpcy5zaGlwcGluZ09wdGlvbnNba2V5XSA9IHtcbiAgICAgICAgICAgICAgICBwcmltYXJ5X3JhdGU6IE51bWJlcihzaGlwcGluZ0Rpdi5kYXRhc2V0WydwcmltYXJ5X3JhdGUnXSksXG4gICAgICAgICAgICAgICAgYWRkX29uX3JhdGU6IE51bWJlcihzaGlwcGluZ0Rpdi5kYXRhc2V0WydhZGRfb25fcmF0ZSddKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucXVhbnRpdHlJbnB1dCA9IHByb2R1Y3RDb250YWluZXIucXVlcnlTZWxlY3RvcignLmVhc3lfcHJvZHVjdHMtcXVhbnRpdHlfaW5wdXQnKTtcbiAgICAgICAgdGhpcy50b3RhbERpc3BsYXkgPSBwcm9kdWN0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5lYXN5X3Byb2R1Y3RzLXByb2R1Y3RfdG90YWxfZGlzcGxheScpO1xuICAgICAgICB0aGlzLnByb2R1Y3RUb3RhbCA9IHByb2R1Y3RDb250YWluZXIucXVlcnlTZWxlY3RvcignLmVhc3lfcHJvZHVjdHMtcHJvZHVjdF90b3RhbCcpO1xuXG4gICAgICAgIHRoaXMucXVhbnRpdHlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLnF1YW50aXR5Q2hhbmdlZC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBxdWFudGl0eSBhbmQgdXBkYXRlcyB0aGUgY29zdCB2YXJpYWJsZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSBxdWFudGl0eVxuICAgICAqL1xuICAgIHNldFF1YW50aXR5IChxdWFudGl0eSkge1xuICAgICAgICB0aGlzLnF1YW50aXR5ID0gcXVhbnRpdHk7XG4gICAgICAgIHRoaXMudG90YWwgPSBxdWFudGl0eSAqIHRoaXMuY29zdDtcblxuICAgICAgICBpZiAodGhpcy5xdWFudGl0eSAhPSB0aGlzLnF1YW50aXR5SW5wdXQudmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMucXVhbnRpdHlJbnB1dC52YWx1ZSA9IHRoaXMucXVhbnRpdHk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy50b3RhbCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucHJvZHVjdFRvdGFsLmlubmVySFRNTCA9IHRoaXMudG90YWwudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIHRoaXMudG90YWxEaXNwbGF5LnN0eWxlLmRpc3BsYXkgPSAnJ1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50b3RhbERpc3BsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHF1YW50aXR5IGhhcyBjaGFuZ2VkIGluIHRoZSBpbnB1dCwgYW5kIHdpbGwgcmVjYWxjdWxhdGUgdGhlIHRvdGFscyBmb3IgdGhpcyBwcm9kdWN0XG4gICAgICovXG4gICAgcXVhbnRpdHlDaGFuZ2VkICgpIHtcblxuICAgICAgICBsZXQgcXVhbnRpdHkgPSBOdW1iZXIodGhpcy5xdWFudGl0eUlucHV0LnZhbHVlKTtcblxuICAgICAgICBpZiAoaXNOYU4ocXVhbnRpdHkpKSB7XG4gICAgICAgICAgICBxdWFudGl0eSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFF1YW50aXR5KHF1YW50aXR5KTtcblxuICAgICAgICBpZiAodHlwZW9mIHRoaXMucXVhbnRpdHlDaGFuZ2VkQ2FsbGJhY2sgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5xdWFudGl0eUNoYW5nZWRDYWxsYmFjayh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJldHJpZXZlcyB0aGUgc2hpcHBpbmcgcmF0ZSBmb3IgdGhlIHNwZWNpZmllZCByZWdpb25cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWdpb25JZFxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIHJldHJpZXZlU2hpcHBpbmdSYXRlcyAocmVnaW9uSWQpIHtcbiAgICAgICAgbGV0IHJhdGVzID0gdGhpcy5zaGlwcGluZ09wdGlvbnNbcmVnaW9uSWRdO1xuXG4gICAgICAgIHJldHVybiByYXRlcyA/IHJhdGVzIDogdGhpcy5zaGlwcGluZ09wdGlvbnNbJ2RlZmF1bHQnXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb21wYXJlIGZ1bmN0aW9uIGZvciBjb21wYXJpbmcgd2VpZ2h0cyBvZiB0d28gcHJvZHVjdHNcbiAgICAgKlxuICAgICAqIEBwYXJhbSBhIFByb2R1Y3RcbiAgICAgKiBAcGFyYW0gYiBQcm9kdWN0XG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKi9cbiAgICBzdGF0aWMgY29tcGFyZVdlaWdodHMgKGEsIGIpIHtcbiAgICAgICAgaWYgKGEud2VpZ2h0IDwgYi53ZWlnaHQpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYS53ZWlnaHQgPiBiLndlaWdodCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxufSIsIi8qKlxuICogQ3JlYXRlZCBieSBicnljZSBvbiAyLzE2LzE3LlxuICovXG5cbmV4cG9ydCBjbGFzcyBTaGlwcGluZ0ZpZWxkIHtcblxuICAgIC8qKlxuICAgICAqIERlZmF1bHQgY29uc3RydWN0b3IgZm9yIGEgZmllbGRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZCBIVE1MTm9kZVxuICAgICAqIEBwYXJhbSBjaGFuZ2VDYWxsYmFjayBGdW5jdGlvblxuICAgICAqIEBwYXJhbSBjb29raWVGYWN0b3J5IENvb2tpZUZhY3RvcnlcbiAgICAgKiBAcGFyYW0gY29va2llS2V5IFRoZSBrZXkgZm9yIHRoZSBzdG9yZWQgY29va2llXG4gICAgICovXG4gICAgY29uc3RydWN0b3IgKGZpZWxkLCBjaGFuZ2VDYWxsYmFjaywgY29va2llRmFjdG9yeSwgY29va2llS2V5KSB7XG5cbiAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgICAgICB0aGlzLmNoYW5nZUNhbGxiYWNrID0gY2hhbmdlQ2FsbGJhY2s7XG4gICAgICAgIHRoaXMuY29va2llRmFjdG9yeSA9IGNvb2tpZUZhY3Rvcnk7XG4gICAgICAgIHRoaXMuY29va2llS2V5ID0gY29va2llS2V5O1xuXG4gICAgICAgIHRoaXMudmFsdWVFbnRlcmVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucmVxdWlyZWQgPSB0aGlzLmZpZWxkLmhhc0F0dHJpYnV0ZSgncmVxdWlyZWQnKTtcblxuICAgICAgICB0aGlzLmJsYW5rVmFsdWUgPSB0aGlzLmZpZWxkLmRhdGFzZXRbJ2JsYW5rX3ZhbHVlJ107XG5cbiAgICAgICAgbGV0IHN0b3JlZFZhbHVlID0gdGhpcy5jb29raWVGYWN0b3J5LmxvYWRDb29raWUodGhpcy5jb29raWVLZXkpO1xuXG4gICAgICAgIGlmIChzdG9yZWRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5maWVsZC52YWx1ZSA9IHN0b3JlZFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jaGVja0lucHV0VmFsdWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZmllbGQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy52ZXJpZnlJbnB1dFZhbHVlLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgaWYgdGhlIHVzZXIgaGFzIGVudGVyZWQgYSBwcm9wZXIgdmFsdWVcbiAgICAgKi9cbiAgICBjaGVja0lucHV0VmFsdWUgKCkge1xuXG4gICAgICAgIHRoaXMudmFsdWVFbnRlcmVkID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMuZmllbGQudmFsdWUpIHtcblxuICAgICAgICAgICAgaWYgKHRoaXMuYmxhbmtWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVFbnRlcmVkID0gdGhpcy5ibGFua1ZhbHVlICE9IHRoaXMuZmllbGQudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRW50ZXJlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBkb3VibGUgY2hlY2tzIGlucHV0IHZhbHVlIHdoZW4gaXQgY2hhbmdlcyB0byB2ZXJpZnkgYSB2YWx1ZSB3YXMgZW50ZXJlZCBwcm9wZXJseVxuICAgICAqL1xuICAgIHZlcmlmeUlucHV0VmFsdWUgKCkge1xuICAgICAgICB0aGlzLmNoZWNrSW5wdXRWYWx1ZSgpO1xuXG4gICAgICAgIGlmICh0aGlzLnZhbHVlRW50ZXJlZCkge1xuICAgICAgICAgICAgdGhpcy5jb29raWVGYWN0b3J5LnNhdmVDb29raWUodGhpcy5jb29raWVLZXksIHRoaXMuZmllbGQudmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VDYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHdoZXRoZXIgb3Igbm90IHRoaXMgZmllbGQgaXMgcmVhZHkgZm9yIHN1Ym1pc3Npb25cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEJvb2xlYW5cbiAgICAgKi9cbiAgICBjaGVja0lmQ29tcGxldGUgKCkge1xuXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVpcmVkID8gdGhpcy52YWx1ZUVudGVyZWQgOiB0cnVlO1xuICAgIH1cbn0iLCIvKipcbiAqIENyZWF0ZWQgYnkgYnJ5Y2Ugb24gMi8xNi8xNy5cbiAqL1xuXG5pbXBvcnQge1NoaXBwaW5nRmllbGR9IGZyb20gJy4vU2hpcHBpbmdGaWVsZCc7XG5cbmV4cG9ydCBjbGFzcyBTaGlwcGluZ01hbmFnZXIge1xuXG4gICAgLyoqXG4gICAgICogTWFuYWdlcyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgc2hpcHBpbmcgb3B0aW9uc1xuICAgICAqXG4gICAgICogQHBhcmFtIGZvcm1cbiAgICAgKiBAcGFyYW0gYWRkcmVzc0NoYW5nZUNhbGxiYWNrIGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIGNvb2tpZUZhY3RvcnkgQ29va2llRmFjdG9yeVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yIChmb3JtLCBhZGRyZXNzQ2hhbmdlQ2FsbGJhY2ssIGNvb2tpZUZhY3RvcnkpIHtcblxuICAgICAgICBTaGlwcGluZ01hbmFnZXIuTkFNRV9DT09LSUUgPSBcIm5hbWVcIjtcbiAgICAgICAgU2hpcHBpbmdNYW5hZ2VyLkFERFJFU1NfMV9DT09LSUUgPSBcImFkZHJlc3NfMVwiO1xuICAgICAgICBTaGlwcGluZ01hbmFnZXIuQUREUkVTU18yX0NPT0tJRSA9IFwiYWRkcmVzc18yXCI7XG4gICAgICAgIFNoaXBwaW5nTWFuYWdlci5DSVRZX0NPT0tJRSA9IFwiY2l0eVwiO1xuICAgICAgICBTaGlwcGluZ01hbmFnZXIuUE9TVEFMX0NPREVfQ09PS0lFID0gXCJwb3N0YWxfY29kZVwiO1xuICAgICAgICBTaGlwcGluZ01hbmFnZXIuU1RBVEVfQ09PS0lFID0gXCJzdGF0ZVwiO1xuICAgICAgICBTaGlwcGluZ01hbmFnZXIuQ09VTlRSWV9DT09LSUUgPSBcImNvdW50cnlcIjtcblxuICAgICAgICBsZXQgbmFtZUlucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiI2Vhc3lfcHJvZHVjdHMtbmFtZVwiKTtcbiAgICAgICAgbGV0IGFkZHJlc3MxSW5wdXQgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjZWFzeV9wcm9kdWN0cy1hZGRyZXNzXzFcIik7XG4gICAgICAgIGxldCBhZGRyZXNzMklucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiI2Vhc3lfcHJvZHVjdHMtYWRkcmVzc18yXCIpO1xuICAgICAgICBsZXQgY2l0eUlucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiI2Vhc3lfcHJvZHVjdHMtY2l0eVwiKTtcbiAgICAgICAgbGV0IHBvc3RhbENvZGVJbnB1dCA9IGZvcm0ucXVlcnlTZWxlY3RvcihcIiNlYXN5X3Byb2R1Y3RzLXBvc3RhbF9jb2RlXCIpO1xuICAgICAgICBsZXQgc3RhdGVJbnB1dCA9IGZvcm0ucXVlcnlTZWxlY3RvcihcIiNlYXN5X3Byb2R1Y3RzLXN0YXRlXCIpO1xuICAgICAgICBsZXQgY291bnRyeVNlbGVjdCA9IGZvcm0ucXVlcnlTZWxlY3RvcihcIiNlYXN5X3Byb2R1Y3RzLWNvdW50cnlcIik7XG5cbiAgICAgICAgdGhpcy5uYW1lRmllbGQgPSBuZXcgU2hpcHBpbmdGaWVsZChuYW1lSW5wdXQsIGFkZHJlc3NDaGFuZ2VDYWxsYmFjaywgY29va2llRmFjdG9yeSwgU2hpcHBpbmdNYW5hZ2VyLk5BTUVfQ09PS0lFKTtcbiAgICAgICAgdGhpcy5hZGRyZXNzMUZpZWxkID0gbmV3IFNoaXBwaW5nRmllbGQoYWRkcmVzczFJbnB1dCwgYWRkcmVzc0NoYW5nZUNhbGxiYWNrLCBjb29raWVGYWN0b3J5LCBTaGlwcGluZ01hbmFnZXIuQUREUkVTU18xX0NPT0tJRSk7XG4gICAgICAgIHRoaXMuYWRkcmVzczJGaWVsZCA9IG5ldyBTaGlwcGluZ0ZpZWxkKGFkZHJlc3MySW5wdXQsIGFkZHJlc3NDaGFuZ2VDYWxsYmFjaywgY29va2llRmFjdG9yeSwgU2hpcHBpbmdNYW5hZ2VyLkFERFJFU1NfMl9DT09LSUUpO1xuICAgICAgICB0aGlzLmNpdHlGaWVsZCA9IG5ldyBTaGlwcGluZ0ZpZWxkKGNpdHlJbnB1dCwgYWRkcmVzc0NoYW5nZUNhbGxiYWNrLCBjb29raWVGYWN0b3J5LCBTaGlwcGluZ01hbmFnZXIuQ0lUWV9DT09LSUUpO1xuICAgICAgICB0aGlzLnBvc3RhbENvZGVGaWVsZCA9IG5ldyBTaGlwcGluZ0ZpZWxkKHBvc3RhbENvZGVJbnB1dCwgYWRkcmVzc0NoYW5nZUNhbGxiYWNrLCBjb29raWVGYWN0b3J5LCBTaGlwcGluZ01hbmFnZXIuUE9TVEFMX0NPREVfQ09PS0lFKTtcbiAgICAgICAgdGhpcy5zdGF0ZUZpZWxkID0gbmV3IFNoaXBwaW5nRmllbGQoc3RhdGVJbnB1dCwgYWRkcmVzc0NoYW5nZUNhbGxiYWNrLCBjb29raWVGYWN0b3J5LCBTaGlwcGluZ01hbmFnZXIuU1RBVEVfQ09PS0lFKTtcbiAgICAgICAgdGhpcy5jb3VudHJ5RmllbGQgPSBuZXcgU2hpcHBpbmdGaWVsZChjb3VudHJ5U2VsZWN0LCBhZGRyZXNzQ2hhbmdlQ2FsbGJhY2ssIGNvb2tpZUZhY3RvcnksIFNoaXBwaW5nTWFuYWdlci5DT1VOVFJZX0NPT0tJRSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGFsbCBmaWVsZHMgdG8gc2VlIGlmIHRoZSBzaGlwcGluZyBpcyByZWFkeSB0byBnb1xuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICovXG4gICAgY2hlY2tJZlNoaXBwaW5nQ29tcGxldGUoKSB7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZUZpZWxkLmNoZWNrSWZDb21wbGV0ZSgpICYmIHRoaXMuYWRkcmVzczFGaWVsZC5jaGVja0lmQ29tcGxldGUoKVxuICAgICAgICAgICAgICAgICYmIHRoaXMuYWRkcmVzczJGaWVsZC5jaGVja0lmQ29tcGxldGUoKSAmJiB0aGlzLmNpdHlGaWVsZC5jaGVja0lmQ29tcGxldGUoKVxuICAgICAgICAgICAgICAgICYmIHRoaXMucG9zdGFsQ29kZUZpZWxkLmNoZWNrSWZDb21wbGV0ZSgpICYmIHRoaXMuc3RhdGVGaWVsZC5jaGVja0lmQ29tcGxldGUoKVxuICAgICAgICAgICAgICAgICYmIHRoaXMuY291bnRyeUZpZWxkLmNoZWNrSWZDb21wbGV0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHNlbGVjdGVkIHJlZ2lvbiBpZCBvciB1bmRlZmluZWQgaWYgbm9uZSBoYXMgYmVlbiBmb3VuZFxuICAgICAqXG4gICAgICogQHJldHVybnMgQm9vbGVhbnx1bmRlZmluZWRcbiAgICAgKi9cbiAgICBnZXRSZWdpb25JZCAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvdW50cnlGaWVsZC5jaGVja0lmQ29tcGxldGUoKSA/IHRoaXMuY291bnRyeUZpZWxkLmZpZWxkLnZhbHVlIDogdW5kZWZpbmVkO1xuICAgIH1cbn0iLCIvKipcbiAqIENyZWF0ZWQgYnkgYnJ5Y2Ugb24gMi84LzE3LlxuICovXG5cbmltcG9ydCB7UHJvZHVjdH0gZnJvbSAnLi9Qcm9kdWN0JztcbmltcG9ydCB7Q29va2llRmFjdG9yeX0gZnJvbSAnLi9Db29raWVGYWN0b3J5JztcbmltcG9ydCB7U2hpcHBpbmdNYW5hZ2VyfSBmcm9tICcuL1NoaXBwaW5nTWFuYWdlcic7XG5cbmV4cG9ydCBjbGFzcyBTaG9wcGluZ0NhcnQge1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgZm9yIHRoaXMgc2hvcHBpbmcgY2FydCBpbnN0YW5jZVxuICAgICAqXG4gICAgICogQHBhcmFtIHByb2R1Y3RzRm9ybSB0aGUgZG9tIGZvcm1cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvciAocHJvZHVjdHNGb3JtKSB7XG4gICAgICAgIFNob3BwaW5nQ2FydC5QUk9EVUNUU19DT09LSUUgPSAncHJvZHVjdF9xdWFudGl0aWVzJztcblxuICAgICAgICB0aGlzLnByb2R1Y3RzRm9ybSA9IHByb2R1Y3RzRm9ybTtcblxuICAgICAgICB0aGlzLnN1YnRvdGFsRGlzcGxheSA9IHRoaXMucHJvZHVjdHNGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNlYXN5X3Byb2R1Y3RzLXN1YnRvdGFsJyk7XG4gICAgICAgIHRoaXMuc2hpcHBpbmdEaXNwbGF5ID0gdGhpcy5wcm9kdWN0c0Zvcm0ucXVlcnlTZWxlY3RvcignI2Vhc3lfcHJvZHVjdHMtc2hpcHBpbmdfdG90YWwnKTtcbiAgICAgICAgdGhpcy50b3RhbERpc3BsYXkgPSB0aGlzLnByb2R1Y3RzRm9ybS5xdWVyeVNlbGVjdG9yKCcjZWFzeV9wcm9kdWN0cy10b3RhbCcpO1xuXG4gICAgICAgIHRoaXMuc3VibWl0QnV0dG9uID0gdGhpcy5wcm9kdWN0c0Zvcm0ucXVlcnlTZWxlY3RvcignI2Vhc3lfcHJvZHVjdHMtc3VibWl0Jyk7XG5cbiAgICAgICAgdGhpcy5jb29raWVGYWN0b3J5ID0gbmV3IENvb2tpZUZhY3RvcnkoJ2Vhc3lfcHJvZHVjdHMnKTtcblxuICAgICAgICB0aGlzLnByb2R1Y3RRdWFudGl0aWVzID0gdGhpcy5jb29raWVGYWN0b3J5LmxvYWRKU09OKFNob3BwaW5nQ2FydC5QUk9EVUNUU19DT09LSUUpO1xuICAgICAgICBsZXQgdW5zb3J0ZWRQcm9kdWN0cyA9IFtdO1xuXG4gICAgICAgIGxldCBwcm9kdWN0Q29udGFpbmVycyA9IHRoaXMucHJvZHVjdHNGb3JtLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Vhc3lfcHJvZHVjdHMtcHJvZHVjdCcpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvZHVjdENvbnRhaW5lcnMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgbGV0IHByb2R1Y3QgPSBuZXcgUHJvZHVjdChwcm9kdWN0Q29udGFpbmVyc1tpXSwgdGhpcy5xdWFudGl0eUNoYW5nZWQuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgICAgIGxldCBzdG9yZWRRdWFudGl0eSA9IHRoaXMucHJvZHVjdFF1YW50aXRpZXNbcHJvZHVjdC5pZF07XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RvcmVkUXVhbnRpdHkgIT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICBzdG9yZWRRdWFudGl0eSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHByb2R1Y3Quc2V0UXVhbnRpdHkoc3RvcmVkUXVhbnRpdHkpO1xuXG4gICAgICAgICAgICB1bnNvcnRlZFByb2R1Y3RzLnB1c2gocHJvZHVjdCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb2R1Y3RzID0gdW5zb3J0ZWRQcm9kdWN0cy5zb3J0KFByb2R1Y3QuY29tcGFyZVdlaWdodHMpLnJldmVyc2UoKTtcblxuICAgICAgICB0aGlzLnNoaXBwaW5nTWFuYWdlciA9IG5ldyBTaGlwcGluZ01hbmFnZXIodGhpcy5wcm9kdWN0c0Zvcm0sIHRoaXMuY2hlY2tTaGlwcGluZ0FkZHJlc3MuYmluZCh0aGlzKSwgdGhpcy5jb29raWVGYWN0b3J5KTtcblxuICAgICAgICB0aGlzLmNhbGN1bGF0ZVRvdGFscygpO1xuXG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImNvbXBsZXRlXCIgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJsb2FkZWRcIikge1xuICAgICAgICAgICAgdGhpcy5zZXR1cFN1Ym1pdENhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgdGhpcy5zZXR1cFN1Ym1pdENhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHVwIHRoZSBjb21wbGV0ZSBjYWxsYmFja1xuICAgICAqL1xuICAgIHNldHVwU3VibWl0Q2FsbGJhY2sgKCkge1xuXG4gICAgICAgIGxldCBzdWJtaXRDYWxsYmFja05hbWUgPSB0aGlzLnByb2R1Y3RzRm9ybS5kYXRhc2V0WydzdWJtaXRfY2FsbGJhY2snXTtcblxuICAgICAgICBpZiAoc3VibWl0Q2FsbGJhY2tOYW1lKSB7XG4gICAgICAgICAgICBsZXQgc3VibWl0Q2FsbGJhY2sgPSBldmFsKHN1Ym1pdENhbGxiYWNrTmFtZSk7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3VibWl0Q2FsbGJhY2sgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0Q2FsbGJhY2sgPSBzdWJtaXRDYWxsYmFjaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucHJvZHVjdHNGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0Rm9ybS5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wcyB0aGUgc3VibWlzc2lvbiBpZiBhIGNvbXBsZXRlIGNhbGxiYWNrIGlzIHNldFxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICovXG4gICAgc3VibWl0Rm9ybSAoZXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuc3VibWl0Q2FsbGJhY2spIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIHRoaXMuc3VibWl0Q2FsbGJhY2sodGhpcy50b3RhbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjaGVja3MgdG8gc2VlIGlmIHRoZSBzaGlwcGluZyBhZGRyZXNzIGhhcyBiZWVuIGNoYW5nZWRcbiAgICAgKi9cbiAgICBjaGVja1NoaXBwaW5nQWRkcmVzcyAoKSB7XG5cbiAgICAgICAgaWYgKHRoaXMuc2hpcHBpbmdNYW5hZ2VyLmNoZWNrSWZTaGlwcGluZ0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlVG90YWxzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNoaXBwaW5nRGlzcGxheS5pbm5lckhUTUwgPSAnUGxlYXNlIEVudGVyIFlvdXIgU2hpcHBpbmcgQWRkcmVzcyc7XG4gICAgICAgICAgICB0aGlzLnRvdGFsRGlzcGxheS5pbm5lckhUTUwgPSAnUGxlYXNlIEVudGVyIFlvdXIgU2hpcHBpbmcgQWRkcmVzcyc7XG5cbiAgICAgICAgICAgIHRoaXMuc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuZXZlciBhIHF1YW50aXR5IGhhcyBjaGFuZ2VkXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJvZHVjdCBQcm9kdWN0XG4gICAgICovXG4gICAgcXVhbnRpdHlDaGFuZ2VkIChwcm9kdWN0KSB7XG4gICAgICAgIHRoaXMucHJvZHVjdFF1YW50aXRpZXNbcHJvZHVjdC5pZF0gPSBwcm9kdWN0LnF1YW50aXR5O1xuICAgICAgICB0aGlzLmNvb2tpZUZhY3Rvcnkuc2F2ZUpTT04oU2hvcHBpbmdDYXJ0LlBST0RVQ1RTX0NPT0tJRSwgdGhpcy5wcm9kdWN0UXVhbnRpdGllcyk7XG5cbiAgICAgICAgdGhpcy5jYWxjdWxhdGVUb3RhbHMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWNhbGN1bGF0ZXMgYWxsIHRvdGFsc1xuICAgICAqL1xuICAgIGNhbGN1bGF0ZVRvdGFscyAoKSB7XG5cbiAgICAgICAgbGV0IHN1YnRvdGFsID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByb2R1Y3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzdWJ0b3RhbCs9IHRoaXMucHJvZHVjdHNbaV0udG90YWw7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnN1YnRvdGFsRGlzcGxheS5pbm5lckhUTUwgPSAnJCcgKyBzdWJ0b3RhbC50b0ZpeGVkKDIpO1xuXG4gICAgICAgIGlmICh0aGlzLnNoaXBwaW5nTWFuYWdlci5jaGVja0lmU2hpcHBpbmdDb21wbGV0ZSgpKSB7XG5cbiAgICAgICAgICAgIGxldCBzaGlwcGluZ1RvdGFsID0gMDtcbiAgICAgICAgICAgIGxldCByZWdpb25JZCA9IHRoaXMuc2hpcHBpbmdNYW5hZ2VyLmdldFJlZ2lvbklkKCk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wcm9kdWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCBwcm9kdWN0ID0gdGhpcy5wcm9kdWN0c1tpXTtcblxuICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0LnF1YW50aXR5KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IHNoaXBwaW5nUmF0ZXMgPSBwcm9kdWN0LnJldHJpZXZlU2hpcHBpbmdSYXRlcyhyZWdpb25JZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGFkZE9uUXVhbnRpdHkgPSBwcm9kdWN0LnF1YW50aXR5O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzaGlwcGluZ1RvdGFsID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoaXBwaW5nVG90YWwrPSBzaGlwcGluZ1JhdGVzLnByaW1hcnlfcmF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZE9uUXVhbnRpdHktLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWRkT25RdWFudGl0eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hpcHBpbmdUb3RhbCs9IHNoaXBwaW5nUmF0ZXMuYWRkX29uX3JhdGUgKiBhZGRPblF1YW50aXR5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNoaXBwaW5nRGlzcGxheS5pbm5lckhUTUwgPSAnJCcgKyBzaGlwcGluZ1RvdGFsLnRvRml4ZWQoMik7XG5cbiAgICAgICAgICAgIHRoaXMudG90YWwgPSBzdWJ0b3RhbCArIHNoaXBwaW5nVG90YWw7XG5cbiAgICAgICAgICAgIHRoaXMudG90YWxEaXNwbGF5LmlubmVySFRNTCA9ICckJyArIHRoaXMudG90YWwudG9GaXhlZCgyKTtcblxuICAgICAgICAgICAgdGhpcy5zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCIvKipcbiAqIENyZWF0ZWQgYnkgYnJ5Y2Ugb24gMi84LzE3LlxuICovXG5cbmltcG9ydCB7U2hvcHBpbmdDYXJ0fSBmcm9tICcuL2NsYXNzZXMvU2hvcHBpbmdDYXJ0JztcblxubGV0IHByb2R1Y3RzRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlYXN5X3Byb2R1Y3RzLXByb2R1Y3RzX2xpc3QnKTtcblxuaWYgKHR5cGVvZiBwcm9kdWN0c0Zvcm0gIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBuZXcgU2hvcHBpbmdDYXJ0KHByb2R1Y3RzRm9ybSk7XG59Il19"}